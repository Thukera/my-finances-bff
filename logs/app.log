
[DEBUG] 2025-08-30 18:24:22.026 [restartedMain] JdbcResourceLocalTransactionCoordinatorImpl - JDBC transaction marked for rollback-only (exception provided for stack trace)
java.lang.Exception: exception just for purpose of providing stack trace
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.markRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:309) ~[hibernate-core-6.6.18.Final.jar:6.6.18.Final]
	at org.hibernate.internal.AbstractSharedSessionContract.buildNamedQuery(AbstractSharedSessionContract.java:1141) ~[hibernate-core-6.6.18.Final.jar:6.6.18.Final]
	at org.hibernate.internal.AbstractSharedSessionContract.createNamedQuery(AbstractSharedSessionContract.java:1019) ~[hibernate-core-6.6.18.Final.jar:6.6.18.Final]
	at org.hibernate.internal.AbstractSharedSessionContract.createNamedQuery(AbstractSharedSessionContract.java:143) ~[hibernate-core-6.6.18.Final.jar:6.6.18.Final]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[?:?]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[?:?]
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:364) ~[spring-orm-6.2.8.jar:6.2.8]
	at jdk.proxy4/jdk.proxy4.$Proxy165.createNamedQuery(Unknown Source) ~[?:?]
	at org.springframework.data.jpa.repository.query.NamedQuery.hasNamedQuery(NamedQuery.java:120) ~[spring-data-jpa-3.5.1.jar:3.5.1]
	at org.springframework.data.jpa.repository.query.NamedQuery.lookupFrom(NamedQuery.java:147) ~[spring-data-jpa-3.5.1.jar:3.5.1]
	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$DeclaredQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:184) ~[spring-data-jpa-3.5.1.jar:3.5.1]
	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:254) ~[spring-data-jpa-3.5.1.jar:3.5.1]
	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:99) ~[spring-data-jpa-3.5.1.jar:3.5.1]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:116) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.mapMethodsToQuery(QueryExecutorMethodInterceptor.java:104) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lambda$new$0(QueryExecutorMethodInterceptor.java:92) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at java.base/java.util.Optional.map(Optional.java:260) ~[?:?]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.<init>(QueryExecutorMethodInterceptor.java:92) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:434) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.lambda$afterPropertiesSet$4(RepositoryFactoryBeanSupport.java:350) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.util.Lazy.getNullable(Lazy.java:135) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.util.Lazy.get(Lazy.java:113) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.afterPropertiesSet(RepositoryFactoryBeanSupport.java:356) ~[spring-data-commons-3.5.1.jar:3.5.1]
	at org.springframework.data.jpa.repository.support.JpaRepositoryFactoryBean.afterPropertiesSet(JpaRepositoryFactoryBean.java:132) ~[spring-data-jpa-3.5.1.jar:3.5.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1683) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1628) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:785) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:768) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:146) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:509) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1459) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339) ~[spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373) [spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337) [spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) [spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1222) [spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1188) [spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1123) [spring-beans-6.2.8.jar:6.2.8]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987) [spring-context-6.2.8.jar:6.2.8]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627) [spring-context-6.2.8.jar:6.2.8]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) [spring-boot-3.5.3.jar:3.5.3]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752) [spring-boot-3.5.3.jar:3.5.3]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439) [spring-boot-3.5.3.jar:3.5.3]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318) [spring-boot-3.5.3.jar:3.5.3]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361) [spring-boot-3.5.3.jar:3.5.3]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350) [spring-boot-3.5.3.jar:3.5.3]
	at com.thukera.MyFinancesBffApplication.main(MyFinancesBffApplication.java:15) [classes/:?]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[?:?]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[?:?]
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:50) [spring-boot-devtools-3.5.3.jar:3.5.3]
[WARN ] 2025-08-30 18:24:22.248 [restartedMain] JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
[DEBUG] 2025-08-30 18:24:22.615 [restartedMain] ResourceBundleMessageInterpolator - Loaded expression factory via original TCCL
[DEBUG] 2025-08-30 18:24:22.616 [restartedMain] AbstractConfigurationImpl - Setting custom MessageInterpolator of type org.springframework.validation.beanvalidation.LocaleContextMessageInterpolator
[DEBUG] 2025-08-30 18:24:22.616 [restartedMain] AbstractConfigurationImpl - Setting custom ConstraintValidatorFactory of type org.springframework.validation.beanvalidation.SpringConstraintValidatorFactory
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] ValidationXmlParser - Trying to load META-INF/validation.xml for XML based Validator configuration.
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] ResourceLoaderHelper - Trying to load META-INF/validation.xml via user class loader
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] ResourceLoaderHelper - Trying to load META-INF/validation.xml via TCCL
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] ResourceLoaderHelper - Trying to load META-INF/validation.xml via Hibernate Validator's class loader
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] ValidationXmlParser - No META-INF/validation.xml found. Using annotation based configuration only.
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] TraversableResolvers - Found jakarta.persistence.Persistence on classpath containing 'getPersistenceUtil'. Assuming JPA 2 environment. Trying to instantiate JPA aware TraversableResolver
[DEBUG] 2025-08-30 18:24:22.619 [restartedMain] TraversableResolvers - Instantiated JPA aware TraversableResolver of type org.hibernate.validator.internal.engine.resolver.JPATraversableResolver.
[DEBUG] 2025-08-30 18:24:22.620 [restartedMain] ValidatorFactoryConfigurationHelper - HV000252: Using org.hibernate.validator.internal.engine.DefaultPropertyNodeNameProvider as property node name provider.
[DEBUG] 2025-08-30 18:24:22.620 [restartedMain] ValidatorFactoryConfigurationHelper - HV000234: Using org.springframework.validation.beanvalidation.LocaleContextMessageInterpolator as ValidatorFactory-scoped message interpolator.
[DEBUG] 2025-08-30 18:24:22.620 [restartedMain] ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.engine.resolver.JPATraversableResolver as ValidatorFactory-scoped traversable resolver.
[DEBUG] 2025-08-30 18:24:22.620 [restartedMain] ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.util.ExecutableParameterNameProvider as ValidatorFactory-scoped parameter name provider.
[DEBUG] 2025-08-30 18:24:22.620 [restartedMain] ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.engine.DefaultClockProvider as ValidatorFactory-scoped clock provider.
[DEBUG] 2025-08-30 18:24:22.620 [restartedMain] ValidatorFactoryConfigurationHelper - HV000234: Using org.hibernate.validator.internal.engine.scripting.DefaultScriptEvaluatorFactory as ValidatorFactory-scoped script evaluator factory.
[INFO ] 2025-08-30 18:24:22.858 [restartedMain] H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:postgresql://localhost:5432/my-finances'
[INFO ] 2025-08-30 18:24:22.982 [restartedMain] OptionalLiveReloadServer - LiveReload server is running on port 35729
[INFO ] 2025-08-30 18:24:23.010 [restartedMain] Http11NioProtocol - Starting ProtocolHandler ["http-nio-9090"]
[INFO ] 2025-08-30 18:24:23.030 [restartedMain] TomcatWebServer - Tomcat started on port 9090 (http) with context path '/'
[INFO ] 2025-08-30 18:24:23.038 [restartedMain] MyFinancesBffApplication - Started MyFinancesBffApplication in 6.704 seconds (process running for 7.949)
[INFO ] 2025-08-30 18:24:23.042 [restartedMain] MyFinancesBffApplication - ###### ######## ######## ######### ######## ######## ##########
[INFO ] 2025-08-30 18:24:23.042 [restartedMain] MyFinancesBffApplication - ######## ###  MY FINANCES BFF APPLICATION STARTER  ### ########
[INFO ] 2025-08-30 18:24:23.043 [restartedMain] MyFinancesBffApplication - ###### ######## ######## ######### ######## ######## ##########
[INFO ] 2025-08-30 18:24:36.742 [http-nio-9090-exec-1] [/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
[INFO ] 2025-08-30 18:24:36.742 [http-nio-9090-exec-1] DispatcherServlet - Initializing Servlet 'dispatcherServlet'
[INFO ] 2025-08-30 18:24:36.744 [http-nio-9090-exec-1] DispatcherServlet - Completed initialization in 2 ms
[DEBUG] 2025-08-30 18:24:36.836 [http-nio-9090-exec-1] JpaTransactionManager - Creating new transaction with name [com.thukera.user.security.service.UserDetailsServiceImpl.loadUserByUsername]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
[DEBUG] 2025-08-30 18:24:36.837 [http-nio-9090-exec-1] JpaTransactionManager - Opened new EntityManager [SessionImpl(1794627615<open>)] for JPA transaction
[DEBUG] 2025-08-30 18:24:36.841 [http-nio-9090-exec-1] TransactionImpl - On TransactionImpl creation, JpaCompliance#isJpaTransactionComplianceEnabled == false
[DEBUG] 2025-08-30 18:24:36.841 [http-nio-9090-exec-1] TransactionImpl - begin
[DEBUG] 2025-08-30 18:24:36.843 [http-nio-9090-exec-1] JpaTransactionManager - Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@3ca46323]
[DEBUG] 2025-08-30 18:24:36.924 [http-nio-9090-exec-1] create - Created new SQL alias : u1_0
[DEBUG] 2025-08-30 18:24:36.925 [http-nio-9090-exec-1] create - Registration of TableGroup [StandardTableGroup(com.thukera.user.model.entities.User(2))] with identifierForTableGroup [com.thukera.user.model.entities.User] for NavigablePath [com.thukera.user.model.entities.User] 
[DEBUG] 2025-08-30 18:24:36.938 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@1c04cd74
[DEBUG] 2025-08-30 18:24:36.938 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmBasicValuedSimplePath(com.thukera.user.model.entities.User(2).username) 
[DEBUG] 2025-08-30 18:24:36.945 [http-nio-9090-exec-1] AST - DomainResult Graph:
 \-EntityResultImpl [com.thukera.user.model.entities.User(2)]
 |  +-DelayedCollectionFetch [com.thukera.user.model.entities.User(2).creditcards]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).dataCadastro]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).doc]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).email]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).name]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).password]
 |  +-DelayedCollectionFetch [com.thukera.user.model.entities.User(2).roles]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).status]
 |  \-BasicFetch [com.thukera.user.model.entities.User(2).username]

[DEBUG] 2025-08-30 18:24:36.945 [http-nio-9090-exec-1] tree - SQL AST Tree:
    SelectStatement {
      FromClause {
        StandardTableGroup (u1 : com.thukera.user.model.entities.User(2)) {
          primaryTableReference : tb_users as u1_0
        }
      }
    }

[DEBUG] 2025-08-30 18:24:36.958 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = NORMAL
[DEBUG] 2025-08-30 18:24:36.961 [http-nio-9090-exec-1] SQL - select u1_0.id,u1_0.data_cadastro,u1_0.doc,u1_0.email,u1_0.name,u1_0.password,u1_0.status,u1_0.username from tb_users u1_0 where u1_0.username=?
[DEBUG] 2025-08-30 18:24:36.981 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.user.model.entities.User(2).roles -> DelayedCollectionInitializer(com.thukera.user.model.entities.User(2).roles)@1385057007 (PluralAttribute(com.thukera.user.model.entities.User.roles))
	  com.thukera.user.model.entities.User(2) -> EntityJoinedFetchInitializer(com.thukera.user.model.entities.User(2))@82326738 (SingleTableEntityPersister(com.thukera.user.model.entities.User))
	  com.thukera.user.model.entities.User(2).creditcards -> DelayedCollectionInitializer(com.thukera.user.model.entities.User(2).creditcards)@1938762902 (PluralAttribute(com.thukera.user.model.entities.User.creditcards))

[DEBUG] 2025-08-30 18:24:37.013 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = IGNORE
[DEBUG] 2025-08-30 18:24:37.013 [http-nio-9090-exec-1] SQL - select r1_0.user_id,r1_1.id,r1_1.name from tb_user_roles r1_0 join tb_roles r1_1 on r1_1.id=r1_0.role_id where r1_0.user_id=?
[DEBUG] 2025-08-30 18:24:37.016 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.user.model.entities.User.roles -> SetInitializer(com.thukera.user.model.entities.User.roles)@1618407761 (PluralAttribute(com.thukera.user.model.entities.User.roles))
	  com.thukera.user.model.entities.User.roles.{element} -> EntityJoinedFetchInitializer(com.thukera.user.model.entities.User.roles.{element})@208408202 (EntityCollectionPart(com.thukera.user.model.entities.User.roles#{element})@2005351161)

[DEBUG] 2025-08-30 18:24:37.018 [http-nio-9090-exec-1] natural_id - Caching resolution natural-id resolution from load (com.thukera.user.model.entities.Role) : `ROLE_ADMIN` -> `0`
[DEBUG] 2025-08-30 18:24:37.019 [http-nio-9090-exec-1] natural_id - Locally caching natural-id resolution (com.thukera.user.model.entities.Role) : `ROLE_ADMIN` -> `0`
[DEBUG] 2025-08-30 18:24:37.020 [http-nio-9090-exec-1] natural_id - Caching resolution natural-id resolution from load (com.thukera.user.model.entities.Role) : `ROLE_USER` -> `1`
[DEBUG] 2025-08-30 18:24:37.020 [http-nio-9090-exec-1] natural_id - Locally caching natural-id resolution (com.thukera.user.model.entities.Role) : `ROLE_USER` -> `1`
[DEBUG] 2025-08-30 18:24:37.022 [http-nio-9090-exec-1] ResultsHelper - Collection fully initialized: [com.thukera.user.model.entities.User.roles#1]
[DEBUG] 2025-08-30 18:24:37.023 [http-nio-9090-exec-1] JpaTransactionManager - Initiating transaction commit
[DEBUG] 2025-08-30 18:24:37.023 [http-nio-9090-exec-1] JpaTransactionManager - Committing JPA transaction on EntityManager [SessionImpl(1794627615<open>)]
[DEBUG] 2025-08-30 18:24:37.023 [http-nio-9090-exec-1] TransactionImpl - committing
[DEBUG] 2025-08-30 18:24:37.024 [http-nio-9090-exec-1] AbstractFlushingEventListener - Processing flush-time cascades
[DEBUG] 2025-08-30 18:24:37.030 [http-nio-9090-exec-1] AbstractFlushingEventListener - Dirty checking collections
[DEBUG] 2025-08-30 18:24:37.036 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.creditcards#1], was: [com.thukera.user.model.entities.User.creditcards#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.036 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.roles#1], was: [com.thukera.user.model.entities.User.roles#1] (initialized)
[DEBUG] 2025-08-30 18:24:37.037 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 insertions, 0 updates, 0 deletions to 3 objects
[DEBUG] 2025-08-30 18:24:37.037 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 (re)creations, 0 updates, 0 removals to 2 collections
[DEBUG] 2025-08-30 18:24:37.038 [http-nio-9090-exec-1] EntityPrinter - Listing entities:
[DEBUG] 2025-08-30 18:24:37.038 [http-nio-9090-exec-1] EntityPrinter - com.thukera.user.model.entities.Role{name=ROLE_USER, id=1}
[DEBUG] 2025-08-30 18:24:37.038 [http-nio-9090-exec-1] EntityPrinter - com.thukera.user.model.entities.Role{name=ROLE_ADMIN, id=0}
[DEBUG] 2025-08-30 18:24:37.038 [http-nio-9090-exec-1] EntityPrinter - com.thukera.user.model.entities.User{password=$2a$10$/BxGNN/.ng/hhsHBRArSy.Gh4OACoWrcuF3VKUUVD1Xzk1qinlxnu, creditcards=<uninitialized>, roles=[com.thukera.user.model.entities.Role#1, com.thukera.user.model.entities.Role#0], name=admin, doc=123456, id=1, dataCadastro=null, email=email@email, status=true, username=admin}
[DEBUG] 2025-08-30 18:24:37.042 [http-nio-9090-exec-1] JpaTransactionManager - Closing JPA EntityManager [SessionImpl(1794627615<open>)] after transaction
[DEBUG] 2025-08-30 18:24:37.062 [http-nio-9090-exec-1] OpenEntityManagerInViewInterceptor - Opening JPA EntityManager in OpenEntityManagerInViewInterceptor
[DEBUG] 2025-08-30 18:24:37.146 [http-nio-9090-exec-1] CreditcardController - ######## ### INSERT PURCHASE ### ########
[DEBUG] 2025-08-30 18:24:37.152 [http-nio-9090-exec-1] CreditcardController - ### Purchase Form : CreditPurchaseForm(puchaseID=0, descricao=GTA 6, creditCardId=37, invoiceId=0, totalInstallments=1, category=Games, value=500.00, purchaseDateTime=null)
[DEBUG] 2025-08-30 18:24:37.152 [http-nio-9090-exec-1] CreditcardController - ### Auth : UsernamePasswordAuthenticationToken [Principal=com.thukera.user.security.service.UserPrinciple@6e978e81, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_USER, ROLE_ADMIN]]
[DEBUG] 2025-08-30 18:24:37.152 [http-nio-9090-exec-1] CreditcardController - ### Username From Token : admin
[DEBUG] 2025-08-30 18:24:37.153 [http-nio-9090-exec-1] create - Created new SQL alias : u1_0
[DEBUG] 2025-08-30 18:24:37.153 [http-nio-9090-exec-1] create - Registration of TableGroup [StandardTableGroup(com.thukera.user.model.entities.User(2))] with identifierForTableGroup [com.thukera.user.model.entities.User] for NavigablePath [com.thukera.user.model.entities.User] 
[DEBUG] 2025-08-30 18:24:37.153 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@6de8ebb5
[DEBUG] 2025-08-30 18:24:37.153 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmBasicValuedSimplePath(com.thukera.user.model.entities.User(2).username) 
[DEBUG] 2025-08-30 18:24:37.154 [http-nio-9090-exec-1] AST - DomainResult Graph:
 \-EntityResultImpl [com.thukera.user.model.entities.User(2)]
 |  +-DelayedCollectionFetch [com.thukera.user.model.entities.User(2).creditcards]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).dataCadastro]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).doc]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).email]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).name]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).password]
 |  +-DelayedCollectionFetch [com.thukera.user.model.entities.User(2).roles]
 |  +-BasicFetch [com.thukera.user.model.entities.User(2).status]
 |  \-BasicFetch [com.thukera.user.model.entities.User(2).username]

[DEBUG] 2025-08-30 18:24:37.154 [http-nio-9090-exec-1] tree - SQL AST Tree:
    SelectStatement {
      FromClause {
        StandardTableGroup (u1 : com.thukera.user.model.entities.User(2)) {
          primaryTableReference : tb_users as u1_0
        }
      }
    }

[DEBUG] 2025-08-30 18:24:37.154 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = NORMAL
[DEBUG] 2025-08-30 18:24:37.154 [http-nio-9090-exec-1] SQL - select u1_0.id,u1_0.data_cadastro,u1_0.doc,u1_0.email,u1_0.name,u1_0.password,u1_0.status,u1_0.username from tb_users u1_0 where u1_0.username=?
[DEBUG] 2025-08-30 18:24:37.155 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.user.model.entities.User(2).roles -> DelayedCollectionInitializer(com.thukera.user.model.entities.User(2).roles)@2096575274 (PluralAttribute(com.thukera.user.model.entities.User.roles))
	  com.thukera.user.model.entities.User(2) -> EntityJoinedFetchInitializer(com.thukera.user.model.entities.User(2))@403247294 (SingleTableEntityPersister(com.thukera.user.model.entities.User))
	  com.thukera.user.model.entities.User(2).creditcards -> DelayedCollectionInitializer(com.thukera.user.model.entities.User(2).creditcards)@621637125 (PluralAttribute(com.thukera.user.model.entities.User.creditcards))

[DEBUG] 2025-08-30 18:24:37.156 [http-nio-9090-exec-1] CreditcardController - ### Username From Entity : admin
[DEBUG] 2025-08-30 18:24:37.160 [http-nio-9090-exec-1] JpaTransactionManager - Found thread-bound EntityManager [SessionImpl(1827178588<open>)] for JPA transaction
[DEBUG] 2025-08-30 18:24:37.160 [http-nio-9090-exec-1] JpaTransactionManager - Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
[DEBUG] 2025-08-30 18:24:37.161 [http-nio-9090-exec-1] TransactionImpl - On TransactionImpl creation, JpaCompliance#isJpaTransactionComplianceEnabled == false
[DEBUG] 2025-08-30 18:24:37.161 [http-nio-9090-exec-1] TransactionImpl - begin
[DEBUG] 2025-08-30 18:24:37.162 [http-nio-9090-exec-1] JpaTransactionManager - Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@7a304dbc]
[DEBUG] 2025-08-30 18:24:37.174 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = IGNORE
[DEBUG] 2025-08-30 18:24:37.174 [http-nio-9090-exec-1] SQL - select cc1_0.card_id,cc1_0.bank,cc1_0.billing_period_end,cc1_0.billing_period_start,cc1_0.data_cadastro,cc1_0.billing_due_date,cc1_0.end_numbers,cc1_0.nickname,cc1_0.total_limit,cc1_0.used_limit,cc1_0.user_id from tb_credit_card cc1_0 where cc1_0.card_id=?
[DEBUG] 2025-08-30 18:24:37.177 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.creditcard.model.entities.CreditCard.invoices -> DelayedCollectionInitializer(com.thukera.creditcard.model.entities.CreditCard.invoices)@164180413 (PluralAttribute(com.thukera.creditcard.model.entities.CreditCard.invoices))
	  com.thukera.creditcard.model.entities.CreditCard -> EntityJoinedFetchInitializer(com.thukera.creditcard.model.entities.CreditCard)@1668476952 (SingleTableEntityPersister(com.thukera.creditcard.model.entities.CreditCard))
	  com.thukera.creditcard.model.entities.CreditCard.purchases -> DelayedCollectionInitializer(com.thukera.creditcard.model.entities.CreditCard.purchases)@1747272834 (PluralAttribute(com.thukera.creditcard.model.entities.CreditCard.purchases))
	  com.thukera.creditcard.model.entities.CreditCard.user -> EntityDelayedFetchInitializer(com.thukera.creditcard.model.entities.CreditCard.user)@1219285376 (ToOneAttributeMapping(NavigableRole[com.thukera.creditcard.model.entities.CreditCard.user])@136857073)

[DEBUG] 2025-08-30 18:24:37.179 [http-nio-9090-exec-1] JpaTransactionManager - Initiating transaction commit
[DEBUG] 2025-08-30 18:24:37.179 [http-nio-9090-exec-1] JpaTransactionManager - Committing JPA transaction on EntityManager [SessionImpl(1827178588<open>)]
[DEBUG] 2025-08-30 18:24:37.179 [http-nio-9090-exec-1] TransactionImpl - committing
[DEBUG] 2025-08-30 18:24:37.180 [http-nio-9090-exec-1] JpaTransactionManager - Not closing pre-bound JPA EntityManager after transaction
[DEBUG] 2025-08-30 18:24:37.182 [http-nio-9090-exec-1] CreditcardController - ### Creditcard: CreditCard(cardId=37, user=User{id=1, username='admin'}, bank=ITAU, endnumbers=4203, nickname=Gold, billingPeriodStart=10, billingPeriodEnd=9, dueDate=5, usedLimit=0.00, totalLimit=10000.00, dataCadastro=2025-08-29)
[DEBUG] 2025-08-30 18:24:37.182 [http-nio-9090-exec-1] InvoiceService - ----------- ----- INVOICE SERVICE ----- -----------
[DEBUG] 2025-08-30 18:24:37.182 [http-nio-9090-exec-1] InvoiceService - ## Today 2025-08-30
[DEBUG] 2025-08-30 18:24:37.185 [http-nio-9090-exec-1] create - Created new SQL alias : i1_0
[DEBUG] 2025-08-30 18:24:37.185 [http-nio-9090-exec-1] create - Registration of TableGroup [StandardTableGroup(com.thukera.creditcard.model.entities.Invoice(16))] with identifierForTableGroup [com.thukera.creditcard.model.entities.Invoice] for NavigablePath [com.thukera.creditcard.model.entities.Invoice] 
[DEBUG] 2025-08-30 18:24:37.185 [http-nio-9090-exec-1] create - Registration of TableGroup [org.hibernate.sql.ast.tree.from.LazyTableGroup@64c7e1c0] with identifierForTableGroup [com.thukera.creditcard.model.entities.Invoice(16).creditCard] for NavigablePath [com.thukera.creditcard.model.entities.Invoice(16).creditCard] 
[DEBUG] 2025-08-30 18:24:37.186 [http-nio-9090-exec-1] create - Registration of TableGroup [org.hibernate.sql.ast.tree.from.LazyTableGroup@bb1afab] with identifierForTableGroup [com.thukera.creditcard.model.entities.Invoice(16).creditCard] for NavigablePath [com.thukera.creditcard.model.entities.Invoice(16).creditCard] 
[DEBUG] 2025-08-30 18:24:37.186 [http-nio-9090-exec-1] create - Registration of TableGroup [org.hibernate.sql.ast.tree.from.LazyTableGroup@bb1afab] for NavigablePath [com.thukera.creditcard.model.entities.Invoice(16).creditCard] overrode previous registration : org.hibernate.sql.ast.tree.from.LazyTableGroup@64c7e1c0
[DEBUG] 2025-08-30 18:24:37.186 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.JpaCriteriaParameter@2ae11d03
[DEBUG] 2025-08-30 18:24:37.186 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@7ac5f0b
[DEBUG] 2025-08-30 18:24:37.186 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmEntityValuedSimplePath(com.thukera.creditcard.model.entities.Invoice(16).creditCard) 
[DEBUG] 2025-08-30 18:24:37.188 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@124fae8a
[DEBUG] 2025-08-30 18:24:37.188 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmBasicValuedSimplePath(com.thukera.creditcard.model.entities.Invoice(16).status) 
[DEBUG] 2025-08-30 18:24:37.191 [http-nio-9090-exec-1] AST - DomainResult Graph:
 \-EntityResultImpl [com.thukera.creditcard.model.entities.Invoice(16)]
 |  +-CircularFetchImpl [com.thukera.creditcard.model.entities.Invoice(16).creditCard]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).dueDate]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).endDate]
 |  +-DelayedCollectionFetch [com.thukera.creditcard.model.entities.Invoice(16).purchases]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).startDate]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).status]
 |  \-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).totalAmount]

[DEBUG] 2025-08-30 18:24:37.191 [http-nio-9090-exec-1] tree - SQL AST Tree:
    SelectStatement {
      FromClause {
        StandardTableGroup (i1 : com.thukera.creditcard.model.entities.Invoice(16)) {
          primaryTableReference : tb_invoice as i1_0
          TableGroupJoins {
            left  join LazyTableGroup (cc1 : com.thukera.creditcard.model.entities.Invoice(16).creditCard) {
            }
             join LazyTableGroup (cc2 : com.thukera.creditcard.model.entities.Invoice(16).creditCard) {
            }
          }
        }
      }
    }

[DEBUG] 2025-08-30 18:24:37.191 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = NORMAL
[DEBUG] 2025-08-30 18:24:37.191 [http-nio-9090-exec-1] SQL - select i1_0.invoice_id,i1_0.card_id,i1_0.due_date,i1_0.end_date,i1_0.start_date,i1_0.status,i1_0.total_amount from tb_invoice i1_0 where i1_0.card_id=? and i1_0.status=?
[DEBUG] 2025-08-30 18:24:37.193 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.creditcard.model.entities.Invoice(16).purchases -> DelayedCollectionInitializer(com.thukera.creditcard.model.entities.Invoice(16).purchases)@354768102 (PluralAttribute(com.thukera.creditcard.model.entities.Invoice.purchases))
	  com.thukera.creditcard.model.entities.Invoice(16) -> EntityJoinedFetchInitializer(com.thukera.creditcard.model.entities.Invoice(16))@363856982 (SingleTableEntityPersister(com.thukera.creditcard.model.entities.Invoice))
	  com.thukera.creditcard.model.entities.Invoice(16).creditCard -> EntityDelayedFetchInitializer(com.thukera.creditcard.model.entities.Invoice(16).creditCard)@1596711012 (ToOneAttributeMapping(NavigableRole[com.thukera.creditcard.model.entities.Invoice.creditCard])@1892493128)

[DEBUG] 2025-08-30 18:24:37.194 [http-nio-9090-exec-1] InvoiceService - ## Opened Invoice is Present : Optional[Invoice(invoiceId=2352, totalAmount=0.00, startDate=2025-08-10, endDate=2025-09-09, dueDate=2025-09-05, status=OPEN)]
[DEBUG] 2025-08-30 18:24:37.194 [http-nio-9090-exec-1] CreditcardController - ### Current Invoice: Invoice(invoiceId=2352, totalAmount=0.00, startDate=2025-08-10, endDate=2025-09-09, dueDate=2025-09-05, status=OPEN)
[DEBUG] 2025-08-30 18:24:37.194 [http-nio-9090-exec-1] JpaTransactionManager - Found thread-bound EntityManager [SessionImpl(1827178588<open>)] for JPA transaction
[DEBUG] 2025-08-30 18:24:37.195 [http-nio-9090-exec-1] JpaTransactionManager - Creating new transaction with name [com.thukera.creditcard.service.InvoiceService.createPurchase]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
[DEBUG] 2025-08-30 18:24:37.195 [http-nio-9090-exec-1] TransactionImpl - begin
[DEBUG] 2025-08-30 18:24:37.195 [http-nio-9090-exec-1] JpaTransactionManager - Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@5adf0335]
[DEBUG] 2025-08-30 18:24:37.196 [http-nio-9090-exec-1] AbstractFlushingEventListener - Processing flush-time cascades
[DEBUG] 2025-08-30 18:24:37.196 [http-nio-9090-exec-1] AbstractFlushingEventListener - Dirty checking collections
[DEBUG] 2025-08-30 18:24:37.196 [http-nio-9090-exec-1] create - Created new SQL alias : pc1_0
[DEBUG] 2025-08-30 18:24:37.196 [http-nio-9090-exec-1] create - Registration of TableGroup [StandardTableGroup(com.thukera.creditcard.model.entities.PurchaseCategory(22))] with identifierForTableGroup [com.thukera.creditcard.model.entities.PurchaseCategory] for NavigablePath [com.thukera.creditcard.model.entities.PurchaseCategory] 
[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@402cc880
[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmBasicValuedSimplePath(com.thukera.creditcard.model.entities.PurchaseCategory(22).name) 
[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] AST - DomainResult Graph:
 \-EntityResultImpl [com.thukera.creditcard.model.entities.PurchaseCategory(22)]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.PurchaseCategory(22).editable]
 |  \-BasicFetch [com.thukera.creditcard.model.entities.PurchaseCategory(22).name]

[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] tree - SQL AST Tree:
    SelectStatement {
      FromClause {
        StandardTableGroup (pc1 : com.thukera.creditcard.model.entities.PurchaseCategory(22)) {
          primaryTableReference : tb_purchase_category as pc1_0
        }
      }
    }

[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.creditcards#1], was: [com.thukera.user.model.entities.User.creditcards#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.roles#1], was: [com.thukera.user.model.entities.User.roles#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.197 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.CreditCard.invoices#37], was: [com.thukera.creditcard.model.entities.CreditCard.invoices#37] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.CreditCard.purchases#37], was: [com.thukera.creditcard.model.entities.CreditCard.purchases#37] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.Invoice.purchases#2352], was: [com.thukera.creditcard.model.entities.Invoice.purchases#2352] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 insertions, 0 updates, 0 deletions to 3 objects
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 (re)creations, 0 updates, 0 removals to 5 collections
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] EntityPrinter - Listing entities:
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.Invoice{totalAmount=0.00, endDate=2025-09-09, purchases=<uninitialized>, dueDate=2025-09-05, invoiceId=2352, creditCard=com.thukera.creditcard.model.entities.CreditCard#37, startDate=2025-08-10, status=OPEN}
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] EntityPrinter - com.thukera.user.model.entities.User{password=$2a$10$/BxGNN/.ng/hhsHBRArSy.Gh4OACoWrcuF3VKUUVD1Xzk1qinlxnu, creditcards=<uninitialized>, roles=<uninitialized>, name=admin, doc=123456, id=1, dataCadastro=null, email=email@email, status=true, username=admin}
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.CreditCard{billingPeriodStart=10, purchases=<uninitialized>, dueDate=5, billingPeriodEnd=9, bank=ITAU, invoices=<uninitialized>, totalLimit=10000.00, endnumbers=4203, usedLimit=0.00, cardId=37, nickname=Gold, dataCadastro=2025-08-29, user=com.thukera.user.model.entities.User#1}
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = NORMAL
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] SQL - select pc1_0.purchase_category_id,pc1_0.editable,pc1_0."@not_blank" from tb_purchase_category pc1_0 where pc1_0."@not_blank"=?
[DEBUG] 2025-08-30 18:24:37.198 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.creditcard.model.entities.PurchaseCategory(22) -> EntityJoinedFetchInitializer(com.thukera.creditcard.model.entities.PurchaseCategory(22))@2133905193 (SingleTableEntityPersister(com.thukera.creditcard.model.entities.PurchaseCategory))

[DEBUG] 2025-08-30 18:24:37.200 [http-nio-9090-exec-1] InvoiceService - ----------- ----- INVOICE SERVICE ----- -----------
[DEBUG] 2025-08-30 18:24:37.200 [http-nio-9090-exec-1] InvoiceService - ## Today 2025-08-30
[DEBUG] 2025-08-30 18:24:37.201 [http-nio-9090-exec-1] AbstractFlushingEventListener - Processing flush-time cascades
[DEBUG] 2025-08-30 18:24:37.201 [http-nio-9090-exec-1] AbstractFlushingEventListener - Dirty checking collections
[DEBUG] 2025-08-30 18:24:37.201 [http-nio-9090-exec-1] create - Created new SQL alias : i1_0
[DEBUG] 2025-08-30 18:24:37.201 [http-nio-9090-exec-1] create - Registration of TableGroup [StandardTableGroup(com.thukera.creditcard.model.entities.Invoice(16))] with identifierForTableGroup [com.thukera.creditcard.model.entities.Invoice] for NavigablePath [com.thukera.creditcard.model.entities.Invoice] 
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] create - Registration of TableGroup [org.hibernate.sql.ast.tree.from.LazyTableGroup@7dffd425] with identifierForTableGroup [com.thukera.creditcard.model.entities.Invoice(16).creditCard] for NavigablePath [com.thukera.creditcard.model.entities.Invoice(16).creditCard] 
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] create - Registration of TableGroup [org.hibernate.sql.ast.tree.from.LazyTableGroup@29f11577] with identifierForTableGroup [com.thukera.creditcard.model.entities.Invoice(16).creditCard] for NavigablePath [com.thukera.creditcard.model.entities.Invoice(16).creditCard] 
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] create - Registration of TableGroup [org.hibernate.sql.ast.tree.from.LazyTableGroup@29f11577] for NavigablePath [com.thukera.creditcard.model.entities.Invoice(16).creditCard] overrode previous registration : org.hibernate.sql.ast.tree.from.LazyTableGroup@7dffd425
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.JpaCriteriaParameter@2ae11d03
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@3a3ddcf9
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmEntityValuedSimplePath(com.thukera.creditcard.model.entities.Invoice(16).creditCard) 
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmParameter : org.hibernate.query.sqm.tree.expression.SqmJpaCriteriaParameterWrapper@438d1510
[DEBUG] 2025-08-30 18:24:37.202 [http-nio-9090-exec-1] BaseSqmToSqlAstConverter - Determining mapping-model type for SqmPath : SqmBasicValuedSimplePath(com.thukera.creditcard.model.entities.Invoice(16).status) 
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] AST - DomainResult Graph:
 \-EntityResultImpl [com.thukera.creditcard.model.entities.Invoice(16)]
 |  +-CircularFetchImpl [com.thukera.creditcard.model.entities.Invoice(16).creditCard]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).dueDate]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).endDate]
 |  +-DelayedCollectionFetch [com.thukera.creditcard.model.entities.Invoice(16).purchases]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).startDate]
 |  +-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).status]
 |  \-BasicFetch [com.thukera.creditcard.model.entities.Invoice(16).totalAmount]

[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] tree - SQL AST Tree:
    SelectStatement {
      FromClause {
        StandardTableGroup (i1 : com.thukera.creditcard.model.entities.Invoice(16)) {
          primaryTableReference : tb_invoice as i1_0
          TableGroupJoins {
            left  join LazyTableGroup (cc1 : com.thukera.creditcard.model.entities.Invoice(16).creditCard) {
            }
             join LazyTableGroup (cc2 : com.thukera.creditcard.model.entities.Invoice(16).creditCard) {
            }
          }
        }
      }
    }

[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.creditcards#1], was: [com.thukera.user.model.entities.User.creditcards#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.roles#1], was: [com.thukera.user.model.entities.User.roles#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.CreditCard.invoices#37], was: [com.thukera.creditcard.model.entities.CreditCard.invoices#37] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.CreditCard.purchases#37], was: [com.thukera.creditcard.model.entities.CreditCard.purchases#37] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.Invoice.purchases#2352], was: [com.thukera.creditcard.model.entities.Invoice.purchases#2352] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 insertions, 0 updates, 0 deletions to 4 objects
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 (re)creations, 0 updates, 0 removals to 5 collections
[DEBUG] 2025-08-30 18:24:37.203 [http-nio-9090-exec-1] EntityPrinter - Listing entities:
[DEBUG] 2025-08-30 18:24:37.204 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.Invoice{totalAmount=0.00, endDate=2025-09-09, purchases=<uninitialized>, dueDate=2025-09-05, invoiceId=2352, creditCard=com.thukera.creditcard.model.entities.CreditCard#37, startDate=2025-08-10, status=OPEN}
[DEBUG] 2025-08-30 18:24:37.204 [http-nio-9090-exec-1] EntityPrinter - com.thukera.user.model.entities.User{password=$2a$10$/BxGNN/.ng/hhsHBRArSy.Gh4OACoWrcuF3VKUUVD1Xzk1qinlxnu, creditcards=<uninitialized>, roles=<uninitialized>, name=admin, doc=123456, id=1, dataCadastro=null, email=email@email, status=true, username=admin}
[DEBUG] 2025-08-30 18:24:37.204 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.CreditCard{billingPeriodStart=10, purchases=<uninitialized>, dueDate=5, billingPeriodEnd=9, bank=ITAU, invoices=<uninitialized>, totalLimit=10000.00, endnumbers=4203, usedLimit=0.00, cardId=37, nickname=Gold, dataCadastro=2025-08-29, user=com.thukera.user.model.entities.User#1}
[DEBUG] 2025-08-30 18:24:37.204 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.PurchaseCategory{purchaseClassId=2, editable=false, name=Games}
[DEBUG] 2025-08-30 18:24:37.204 [http-nio-9090-exec-1] exec - Skipping reading Query result cache data: cache-enabled = false, cache-mode = NORMAL
[DEBUG] 2025-08-30 18:24:37.204 [http-nio-9090-exec-1] SQL - select i1_0.invoice_id,i1_0.card_id,i1_0.due_date,i1_0.end_date,i1_0.start_date,i1_0.status,i1_0.total_amount from tb_invoice i1_0 where i1_0.card_id=? and i1_0.status=?
[DEBUG] 2025-08-30 18:24:37.205 [http-nio-9090-exec-1] results - Initializer list:
	  com.thukera.creditcard.model.entities.Invoice(16).purchases -> DelayedCollectionInitializer(com.thukera.creditcard.model.entities.Invoice(16).purchases)@1129713543 (PluralAttribute(com.thukera.creditcard.model.entities.Invoice.purchases))
	  com.thukera.creditcard.model.entities.Invoice(16) -> EntityJoinedFetchInitializer(com.thukera.creditcard.model.entities.Invoice(16))@1856925368 (SingleTableEntityPersister(com.thukera.creditcard.model.entities.Invoice))
	  com.thukera.creditcard.model.entities.Invoice(16).creditCard -> EntityDelayedFetchInitializer(com.thukera.creditcard.model.entities.Invoice(16).creditCard)@770528934 (ToOneAttributeMapping(NavigableRole[com.thukera.creditcard.model.entities.Invoice.creditCard])@1892493128)

[DEBUG] 2025-08-30 18:24:37.205 [http-nio-9090-exec-1] InvoiceService - ## Opened Invoice is Present : Optional[Invoice(invoiceId=2352, totalAmount=0.00, startDate=2025-08-10, endDate=2025-09-09, dueDate=2025-09-05, status=OPEN)]
[DEBUG] 2025-08-30 18:24:37.207 [http-nio-9090-exec-1] JpaTransactionManager - Found thread-bound EntityManager [SessionImpl(1827178588<open>)] for JPA transaction
[DEBUG] 2025-08-30 18:24:37.207 [http-nio-9090-exec-1] JpaTransactionManager - Participating in existing transaction
[DEBUG] 2025-08-30 18:24:37.207 [http-nio-9090-exec-1] PersistenceUnitUtilImpl - jakarta.persistence.PersistenceUnitUtil.getIdentifier is only intended to work with enhanced entities (although Hibernate also adapts this support to its proxies); however the passed entity was not enhanced (nor a proxy).. may not be able to read identifier
[DEBUG] 2025-08-30 18:24:37.214 [http-nio-9090-exec-1] SQL - select nextval('seq_purchase')
[DEBUG] 2025-08-30 18:24:37.218 [http-nio-9090-exec-1] SequenceStructure - Sequence value obtained: 65
[DEBUG] 2025-08-30 18:24:37.218 [http-nio-9090-exec-1] AbstractSaveEventListener - Generated identifier: 65, using strategy: org.hibernate.id.enhanced.SequenceStyleGenerator
[DEBUG] 2025-08-30 18:24:37.225 [http-nio-9090-exec-1] JpaTransactionManager - Initiating transaction commit
[DEBUG] 2025-08-30 18:24:37.225 [http-nio-9090-exec-1] JpaTransactionManager - Committing JPA transaction on EntityManager [SessionImpl(1827178588<open>)]
[DEBUG] 2025-08-30 18:24:37.225 [http-nio-9090-exec-1] TransactionImpl - committing
[DEBUG] 2025-08-30 18:24:37.225 [http-nio-9090-exec-1] AbstractFlushingEventListener - Processing flush-time cascades
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] AbstractFlushingEventListener - Dirty checking collections
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] CollectionEntry - Collection dirty: [com.thukera.creditcard.model.entities.Invoice.purchases#2352]
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.creditcards#1], was: [com.thukera.user.model.entities.User.creditcards#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.user.model.entities.User.roles#1], was: [com.thukera.user.model.entities.User.roles#1] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.CreditCard.invoices#37], was: [com.thukera.creditcard.model.entities.CreditCard.invoices#37] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.CreditCard.purchases#37], was: [com.thukera.creditcard.model.entities.CreditCard.purchases#37] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.228 [http-nio-9090-exec-1] Collections - Collection found: [com.thukera.creditcard.model.entities.Invoice.purchases#2352], was: [com.thukera.creditcard.model.entities.Invoice.purchases#2352] (uninitialized)
[DEBUG] 2025-08-30 18:24:37.229 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 1 insertions, 0 updates, 0 deletions to 5 objects
[DEBUG] 2025-08-30 18:24:37.229 [http-nio-9090-exec-1] AbstractFlushingEventListener - Flushed: 0 (re)creations, 1 updates, 0 removals to 5 collections
[DEBUG] 2025-08-30 18:24:37.229 [http-nio-9090-exec-1] EntityPrinter - Listing entities:
[DEBUG] 2025-08-30 18:24:37.229 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.Invoice{totalAmount=0.00, endDate=2025-09-09, purchases=<uninitialized>, dueDate=2025-09-05, invoiceId=2352, creditCard=com.thukera.creditcard.model.entities.CreditCard#37, startDate=2025-08-10, status=OPEN}
[DEBUG] 2025-08-30 18:24:37.229 [http-nio-9090-exec-1] EntityPrinter - com.thukera.user.model.entities.User{password=$2a$10$/BxGNN/.ng/hhsHBRArSy.Gh4OACoWrcuF3VKUUVD1Xzk1qinlxnu, creditcards=<uninitialized>, roles=<uninitialized>, name=admin, doc=123456, id=1, dataCadastro=null, email=email@email, status=true, username=admin}
[DEBUG] 2025-08-30 18:24:37.229 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.CreditPurchase{totalInstallments=1, purchaseDateTime=2025-08-30T18:24:37.218971, installments=null, purchaseId=65, invoice=com.thukera.creditcard.model.entities.Invoice#2352, category=com.thukera.creditcard.model.entities.PurchaseCategory#2, creditCard=com.thukera.creditcard.model.entities.CreditCard#37, value=500.00, descricao=GTA 6}
[DEBUG] 2025-08-30 18:24:37.231 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.CreditCard{billingPeriodStart=10, purchases=<uninitialized>, dueDate=5, billingPeriodEnd=9, bank=ITAU, invoices=<uninitialized>, totalLimit=10000.00, endnumbers=4203, usedLimit=0.00, cardId=37, nickname=Gold, dataCadastro=2025-08-29, user=com.thukera.user.model.entities.User#1}
[DEBUG] 2025-08-30 18:24:37.231 [http-nio-9090-exec-1] EntityPrinter - com.thukera.creditcard.model.entities.PurchaseCategory{purchaseClassId=2, editable=false, name=Games}
[DEBUG] 2025-08-30 18:24:37.242 [http-nio-9090-exec-1] SQL - insert into tb_credit_purchase (tb_purchase_category,card_id,descricao,invoice_id,purchase_date_time,total_installments,value,purchase_id) values (?,?,?,?,?,?,?,?)
[DEBUG] 2025-08-30 18:24:37.249 [http-nio-9090-exec-1] JpaTransactionManager - Not closing pre-bound JPA EntityManager after transaction
[DEBUG] 2025-08-30 18:24:37.298 [http-nio-9090-exec-1] OpenEntityManagerInViewInterceptor - Closing JPA EntityManager in OpenEntityManagerInViewInterceptor
[INFO ] 2025-08-30 18:25:00.622 [RMI TCP Connection(10)-127.0.0.1] SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin - Application shutdown requested.
[INFO ] 2025-08-30 18:25:00.626 [RMI TCP Connection(10)-127.0.0.1] GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
[INFO ] 2025-08-30 18:25:00.628 [tomcat-shutdown] Http11NioProtocol - Pausing ProtocolHandler ["http-nio-9090"]
[INFO ] 2025-08-30 18:25:01.157 [tomcat-shutdown] GracefulShutdown - Graceful shutdown complete
[INFO ] 2025-08-30 18:25:01.158 [RMI TCP Connection(10)-127.0.0.1] Http11NioProtocol - Stopping ProtocolHandler ["http-nio-9090"]
[ERROR] 2025-08-30 18:25:01.158 [http-nio-9090-Acceptor] Acceptor - Socket accept failed
java.nio.channels.AsynchronousCloseException: null
	at java.base/java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:203) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.end(ServerSocketChannelImpl.java:383) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:407) ~[?:?]
	at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:537) ~[tomcat-embed-core-10.1.42.jar:10.1.42]
	at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:72) ~[tomcat-embed-core-10.1.42.jar:10.1.42]
	at org.apache.tomcat.util.net.Acceptor.run(Acceptor.java:127) ~[tomcat-embed-core-10.1.42.jar:10.1.42]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
[INFO ] 2025-08-30 18:25:01.164 [RMI TCP Connection(10)-127.0.0.1] LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
[DEBUG] 2025-08-30 18:25:01.165 [RMI TCP Connection(10)-127.0.0.1] SessionFactoryImpl - HHH000031: Closing
[DEBUG] 2025-08-30 18:25:01.165 [RMI TCP Connection(10)-127.0.0.1] TypeConfiguration$Scope - Un-scoping TypeConfiguration [org.hibernate.type.spi.TypeConfiguration$Scope@647818e2] from SessionFactory [org.hibernate.internal.SessionFactoryImpl@3b5cf31d]
[DEBUG] 2025-08-30 18:25:01.165 [RMI TCP Connection(10)-127.0.0.1] AbstractServiceRegistryImpl - Implicitly destroying ServiceRegistry on de-registration of all child ServiceRegistries
[DEBUG] 2025-08-30 18:25:01.166 [RMI TCP Connection(10)-127.0.0.1] BootstrapServiceRegistryImpl - Implicitly destroying Boot-strap registry on de-registration of all child ServiceRegistries
[INFO ] 2025-08-30 18:25:01.168 [RMI TCP Connection(10)-127.0.0.1] HikariDataSource - HikariPool-1 - Shutdown initiated...
[INFO ] 2025-08-30 18:25:01.177 [RMI TCP Connection(10)-127.0.0.1] HikariDataSource - HikariPool-1 - Shutdown completed.
